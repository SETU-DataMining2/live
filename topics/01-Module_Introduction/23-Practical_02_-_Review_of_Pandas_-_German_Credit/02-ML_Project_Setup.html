<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Data Mining 2</title>

    <!-- Bootstrap core CSS -->
    <link href="../../../style/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../../style/codehilite/css/default.css" rel="stylesheet">
    <link href="../../../style/misc/css/module.css" rel="stylesheet">
    <link href="../../../style/misc/css/practical.css" rel="stylesheet">

	<script type="text/javascript"
	  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>

  </head>

<body>

	<!-- Fixed navbar -->
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			
			
	    	<div class="collapse navbar-collapse">

				<ul class="nav navbar-nav navbar-left">
					<!-- Moodle -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=209060" target="_blank"><img height="18pt" src="../../../style/misc/img/moodle_logo_on_blue.gif" /></a>
						</div>						
					</li>
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://datamining2202425.slack.com" target="_blank"><img height="15pt" src="../../../style/misc/img/slack_logo.png" /></a>
						</div>						
					</li>
				</ul>

	      		<ul class="nav navbar-nav navbar-right">

					<!-- module home -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="../../../index.html"><span class="glyphicon glyphicon-home"></span></a>
						</div>						
					</li>
					
					<!-- topics -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-list-alt"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Topics</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>

					<!-- resources -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-th-list"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Resources</li>
										
										<li >
											<a href="../../../topics/01-Module_Introduction/index.html#01-Module_Overview">Module Overview</a>
										</li>
										
										<li >
											<a href="../../../topics/01-Module_Introduction/index.html#21-Practical_01_-_Review_of_Pandas_-_Drug_Consumption">Practical 01 - Review of Pandas - Drug Consumption</a>
										</li>
										
										<li >
											<a href="../../../topics/01-Module_Introduction/index.html#22-Review_of_Pandas_-_Feedback">Review of Pandas - Feedback</a>
										</li>
										
										<li class="active">
											<a href="../../../topics/01-Module_Introduction/index.html#23-Practical_02_-_Review_of_Pandas_-_German_Credit">Practical 02 - Review of Pandas - German Credit</a>
										</li>
										
										<li >
											<a href="../../../topics/01-Module_Introduction/index.html#31-Top_X_pandas_commands">Top X pandas commands</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>
								
					<!-- pages-->
	        		<li>
						<div class="navbar-collapse collapse" id="c">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span>ML Project Setup</span
									</a>
									<ul class="dropdown-menu" role="menu">
										
										<li >
											<a href="00-Outline.html">Outline</a>
										</li>
										
										<li class="active">
											<a href="02-ML_Project_Setup.html">ML Project Setup</a>
										</li>
										
										<li >
											<a href="03-German_Credit.html">German Credit</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li> 
					
	        	</ul>
			</div>
		</div>
	</div>

	<!-- contents -->
	<div class="container">
		
		<ul class="pager">
			
			<li class="previous"><a href="00-Outline.html">&larr; Previous (Outline)</a></li>
			
			
			
			<li class="next"><a href="03-German_Credit.html">Next (German Credit) &rarr;</a></li>
			
		</ul>
		
		<h1>ML Project Setup</h1>
<h2>Generic Setup</h2>
<p>Below is a project setup that I follow for machine learning projects.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code>datasets
├──<span class="w"> </span>DATASET<span class="w">                        </span>&lt;--<span class="w"> </span>Separate<span class="w"> </span>folder<span class="w"> </span>per<span class="w"> </span>dataset
│<span class="w">   </span>
│<span class="w">   </span>├──<span class="w"> </span>DATASET_-_01_-_Import.ipynb<span class="w">    </span>&lt;--<span class="w"> </span>sequence<span class="w"> </span>of<span class="w"> </span>notebooks<span class="w"> </span>that<span class="w"> </span>
│<span class="w">   </span>├──<span class="w"> </span>DATASET_-_02_-_EDA.ipynb<span class="w">       </span>&lt;--<span class="w">    </span>focus<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>ML<span class="w"> </span>step
│<span class="w">   </span>├──<span class="w"> </span>DATASET_-_03_-_Model.ipynb<span class="w">     </span>&lt;--<span class="w">    </span>each<span class="w"> </span>runnable<span class="w"> </span>as<span class="w"> </span>is<span class="w"> </span>from<span class="w"> </span>current<span class="w"> </span>folder
│<span class="w">   </span>├──<span class="w"> </span>DATASET_04_HP_Tuning.ipynb<span class="w">       </span>│
│<span class="w">   </span>├──<span class="w"> </span>data<span class="w">                   </span>&lt;--<span class="w"> </span>cleaned<span class="w"> </span>data<span class="w"> </span>ready<span class="w"> </span><span class="k">for</span><span class="w"> </span>EDA/analysis
│<span class="w">   </span>├──<span class="w"> </span>orig<span class="w">                   </span>&lt;--<span class="w"> </span>original<span class="w"> </span>data<span class="w"> </span>before<span class="w"> </span>any<span class="w"> </span>cleaning/wrangling/etc
│<span class="w">   </span>└──<span class="w"> </span>output<span class="w">                 </span>&lt;--<span class="w"> </span>all<span class="w"> </span>generated<span class="w"> </span>content
│
├──<span class="w"> </span>DATASET_2
│<span class="w">   </span>.<span class="w"> </span>.<span class="w"> </span>.
└──<span class="w"> </span>DATASET_3
</code></pre></div></td></tr></table></div>

<p>The above file structure and naming convension
has advantages:</p>
<ul>
<li>Reduces the number of copies of the dataset (many of which can be large).</li>
<li>Separation of individual steps in the machine learning workflow <ul>
<li>Reduces computation, reloading of data.</li>
<li>Facilitates automation.</li>
<li>Each notebook is runnable as is &mdash; regularly reset kernel and run all cells to verify that this property remains true. </li>
</ul>
</li>
<li>Notebooks named to indicate dataset, order and purpose.</li>
<li>Based on the practical/assignment I will either ask for the individual notebooks or the notebooks and the contents of the <code>output</code> directory.  We will cover this in a few weeks.</li>
<li>Some of you might use COLAB rather than running on local machines. We want to be able to run/develop the notebooks locally or in COLAB without having to edit the notebook.<ul>
<li>In COLAB all notebooks are stored in the same folder, so we need to include the dataset name in the notebook name, otherwise it is likely you will upload the wrong notebook when submitting your assignments.</li>
<li>We need to link your google drive to the COLAB account so that we can use datasets between notebooks and to save our work for later use. However in COLAB we can't have datasets and output in a sub-folder of the current folder so we will need to update the directory/file access code given below.</li>
</ul>
</li>
</ul>
<p><strong>You don't have to adopt this structure, but in addition to the above it has the advantage, in that if you do, than any issues with grading are my fault and not yours :-).</strong></p>
<h2>Example Setup &mdash; German Credit</h2>
<p>This is a small dataset ((1000 observations) X (20 features + 1 target)) and is available from <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german">UCL</a> in two formats, we are going to use the original format and the associated datasheet so you get more exposure in cleaning data.</p>
<p>The outline of steps needed are:</p>
<p><strong>Step 1:</strong> In your <code>datasets</code> folder create a folder to store all files relating to the German Credit dataset, I use <code>German_Credit</code>.</p>
<p><strong>Step 2:</strong>  <strong>Inside the, just created folder, <code>German_Credit</code></strong> create a new notebook, called <code>German_Credit_-_01_-_Import.ipynb</code> and create a cell with following contents (list of standard imports and settings)</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># pd.set_option(&#39;display.max_rows&#39;, None)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span> 

<span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">666</span>
</code></pre></div></td></tr></table></div>

<p><strong>Step 3:</strong>  Create file tree and download datasets.</p>
<ul>
<li>*Create variable <code>ROOT</code> which contains the root directory which the subfolders 
<code>orig</code>, <code>data</code>, and <code>output</code>. </li>
<li>If working locally then this just the current folder.</li>
<li>All file access from here to the end has a <code>f"{ROOT}/"</code> prefix.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DATASET</span> <span class="o">=</span> <span class="s2">&quot;German Credit&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">COLAB</span> <span class="o">=</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>
<span class="n">ROOT</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>

<span class="k">if</span> <span class="n">COLAB</span><span class="p">:</span>
  <span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">drive</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;/content/gdrive&quot;</span><span class="p">):</span>
    <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;/content/gdrive&quot;</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;/content/gdrive/MyDrive/datasets&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
  <span class="n">ROOT</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/content/gdrive/MyDrive/datasets/</span><span class="si">{</span><span class="n">DATASET</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/&quot;</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ROOT</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ROOT</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">makedirs</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">COLAB</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ROOT</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o777</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;orig&#39;</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;output&#39;</span><span class="p">]:</span> <span class="n">makedirs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>Next cell downloads the required files and save a copy "locally" </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;german.data&quot;</span><span class="p">,</span> <span class="s2">&quot;german.doc&quot;</span><span class="p">,</span> <span class="s2">&quot;german.data-numeric&quot;</span><span class="p">]:</span>
    <span class="n">source</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">target</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s2">/orig/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading remote file </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using local copy of </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p><strong>Step 4:</strong> Import dataset and view data.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s2">/orig/german.data&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>This should have output</p>
<p><img src="files/01-read_csv.png" width=100%></p>
<p>Note:</p>
<ul>
<li>ALWAYS, ALWAYS output the dataset shape &mdash; simplest sanity check of data.</li>
<li>No header information in dataset.</li>
<li>Data is encoded, details in <code>german.doc</code>.</li>
</ul>
<p><strong>Step 5:</strong> Label the columns</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Account_Balance&quot;</span><span class="p">,</span> <span class="s2">&quot;Loan_Duration&quot;</span><span class="p">,</span> <span class="s2">&quot;Credit_History&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Loan_Purpose&quot;</span><span class="p">,</span> <span class="s2">&quot;Loan_Amount&quot;</span><span class="p">,</span> <span class="s2">&quot;Savings&quot;</span><span class="p">,</span> <span class="s2">&quot;Years_Employed&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Installment_Rate&quot;</span><span class="p">,</span> <span class="s2">&quot;Gender_and_Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Other_Debtors_Guarantors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Year_of_Residence&quot;</span><span class="p">,</span> <span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Installment_Plans&quot;</span><span class="p">,</span> <span class="s2">&quot;Housing&quot;</span><span class="p">,</span> <span class="s2">&quot;Existing_Credits&quot;</span><span class="p">,</span> <span class="s2">&quot;Job&quot;</span><span class="p">,</span> <span class="s2">&quot;Dependents&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Telephone&quot;</span><span class="p">,</span> <span class="s2">&quot;Foreign&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Credit_Rating&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

<p><strong>Step 6:</strong> Preprocess the dataset so that it contains descriptive string based on data from <code>german.doc</code> rather just the existing category codes:</p>
<ul>
<li>Create a new dataset, called <code>df_labeled</code>, as a copy of <code>df</code>.</li>
<li>For each categorical feature, replace the category code with a string (code + description) taken from <code>german.doc</code> so the resulting dataset looks like in the following image.</li>
<li>Convert features to suitable type (Category with (un)ordered labels).</li>
</ul>
<p><img src="files/02-labeled.png" width=100%></p>
<p>There is a number of ways to do the above steps. I use regular expressions to parse <code>german.doc</code> and <code>yaml</code> to store the resulting encoding dictionary for later use.  </p>
<p><strong>Step 7:</strong> Save labeled dataset to <code>data</code> folder. Use <code>pickle</code> format, instead of <code>csv</code>, so that meta information (data type, etc) is preserved.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_labeled</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s2">/data/labeled.pkl&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s2">/data/mapping.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;wt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
    <span class="n">yaml</span><span class="o">.</span><span class="n">safe_dump</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>Ok we are now ready to move to the next step, exploratory data analysis (EDA).</p>
		
		<ul class="pager">
			
			<li class="previous"><a href="00-Outline.html">&larr; Previous (Outline)</a></li>
			
			
			
			<li class="next"><a href="03-German_Credit.html">Next (German Credit) &rarr;</a></li>
			
		</ul>

	</div>
	
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../../../style/bootstrap/js/bootstrap.min.js"></script>
	
  </body>
</html>